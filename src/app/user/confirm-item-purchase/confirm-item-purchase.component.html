<div class="index-page" >

  <app-navigation></app-navigation>
  <div class="wrapper">
    <section class="section section-lg section-coins">

      <img src="../../../assets/img/path3.png" class="path">
      <div class="container align-items-center">

        <div class="row">
          <div class="col-lg-12 col-md-6 col-sm-10 ml-auto mr-auto" id="confirmRequest">
            <div *ngIf="(this.storeItemQuery.selectLoading() | async) === false && managerRequests$; else storeLoading">
            <div class="card">
              <div class="card card-coin card-plain">
                <div class="card-body">


                  <div class="row">
                    <div class="col-md-12 text-center">
                      <h3> Hello there!</h3>
                      <span> Confirm Purchase Request</span>
                    </div>
                  </div>

                  <div>
                    <mat-table  #requestTable [dataSource]="managerRequests$" matSort>
                      <ng-container matColumnDef="createdAt">
                        <mat-header-cell *matHeaderCellDef mat-sort-header >Request Date</mat-header-cell>
                        <mat-cell *matCellDef="let UserHasStoreItemModel">{{UserHasStoreItemModel.createdAt | date:'longDate'}}</mat-cell>
                      </ng-container>

                      <ng-container matColumnDef="userUsername">
                        <mat-header-cell *matHeaderCellDef mat-sort-header class="text-center"> Employee </mat-header-cell>
                        <mat-cell *matCellDef="let UserHasStoreItemModel">
                          <div class="col-12">
                            <div class="row">
                              <div class="col-3">
                                <img class="rounded-circle avatar-img" [src]="(entityUserQuery.selectUserByUserId(UserHasStoreItemModel.userId) | async)[0]?.avatarResolvedUrl">
                              </div>
                              <div class="col-9">
                                <div class="row">
                                  Name: {{UserHasStoreItemModel.userFirstName}} {{UserHasStoreItemModel.userLastName}}
                                </div>
                                <div class="row">
                                  Email: {{UserHasStoreItemModel.userEmail}}
                                </div>
                                <div class="row">
                                  Department: {{(entityUserQuery.selectUserByUserId(UserHasStoreItemModel.userId) | async)[0]?.department.Name}}
                                </div>
                              </div>
                            </div>
                          </div>



                        </mat-cell>
                      </ng-container>

                      <ng-container matColumnDef=storeItemName>
                        <mat-header-cell *matHeaderCellDef mat-sort-header> Item </mat-header-cell>
                        <mat-cell *matCellDef="let UserHasStoreItemModel">
                          <div class="col-12">
                            <div class="row">
                              <div class="col-3">
                                <img class="avatar-img" [src]="(storeItemQuery.selectStoreItemById(UserHasStoreItemModel.storeItemId) | async)[0]?.imageResolvedUrl">
                              </div>
                              <div class="col-9">
                                <div class="row">
                                  {{UserHasStoreItemModel.storeItemName}}
                                </div>
                                <div class="row">
                                  Cost: {{UserHasStoreItemModel.storeItemCost}}
                                </div>
                              </div>
                            </div>
                          </div>
                        </mat-cell>
                      </ng-container>

                      <ng-container matColumnDef="status">
                        <mat-header-cell *matHeaderCellDef mat-sort-header> Status </mat-header-cell>
                        <mat-cell *matCellDef="let UserHasStoreItemModel"> {{UserHasStoreItemModel.status}}</mat-cell>
                      </ng-container>

                      <ng-container matColumnDef="action">
                        <mat-header-cell *matHeaderCellDef> Action </mat-header-cell>
                        <mat-cell *matCellDef="let UserHasStoreItemModel">
                          <mat-radio-group >
                            <mat-radio-button [value]="'Approve'" (change)="approvalToggle(UserHasStoreItemModel, $event)">Approve</mat-radio-button>
                            <mat-radio-button [value]="'Decline'" (change)="approvalToggle(UserHasStoreItemModel, $event)">Decline</mat-radio-button>
                            <mat-radio-button checked [value]="'Pending'" (change)="approvalToggle(UserHasStoreItemModel, $event)">Pending</mat-radio-button>
<!--                            <mat-radio-button *ngFor="let approveOption of approveOptions" [checked]="approveOption === approveOptions[0]" (change)="approvalToggle(UserHasStoreItemModel, $event)" [value]="approveOption">
                              {{approveOption.name}}
                            </mat-radio-button>-->
                          </mat-radio-group>
                        </mat-cell>
                      </ng-container>

                      <!--                      <ng-container matColumnDef="declineRequest">
                                              <mat-header-cell *matHeaderCellDef> Decline </mat-header-cell>
                      &lt;!&ndash;                        <mat-cell *matCellDef="let UserHasStoreItemModel"> <mat-checkbox (change)="$event ? approvalToggle(UserHasStoreItemModel) : null" [(ngModel)]="UserHasStoreItemModel.declineRequest"></mat-checkbox> {{UserHasStoreItemModel.declineRequest}}</mat-cell>&ndash;&gt;
                                              <mat-cell *matCellDef="let UserHasStoreItemModel"> <mat-radio-button (change)="$event ? approvalToggle(UserHasStoreItemModel) : null" [(ngModel)]="UserHasStoreItemModel.declineRequest"></mat-radio-button> {{UserHasStoreItemModel.declineRequest}}</mat-cell>

                                            </ng-container>-->

                      <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
                      <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>


                    </mat-table>


                    <div class="container">
                      <button type="button" class="btn btn-success" (click)="openDialog()" >Save</button>
                      <button type="button" class="btn btn-danger" (click)="cancelApproval()" >Cancel</button>
                    </div>

                    <mat-paginator
                      [length] ="100"
                      [pageSize]= "10"
                      [pageSizeOptions] ="[5, 10, 25, 100]">
                    </mat-paginator>

                  </div>

                </div>
              </div>


            </div>

            </div>

            <ng-template #storeLoading>
              Loading...
            </ng-template>
          </div>


        </div>




      </div>

    </section>

  </div>
</div>

